# Rex AI Assistant - Pinned Dependencies
# This file contains exact version pins for reproducible builds and Dependabot updates
# To update: Edit version numbers, test thoroughly, then commit
# Last updated: 2026-01-09

# PyTorch CUDA 12.4 Index (must be before torch packages)
--extra-index-url https://download.pytorch.org/whl/cu124

# ğŸŒ Core Web & API
flask==3.1.1                   # CVE-2025-47278 fixed (fallback key signing issue)
flask-cors==6.0.0              # CVE-2024-6866, CVE-2024-6844, CVE-2024-6839 fixed
flask-limiter==3.8.0
requests==2.32.4               # CVE-2024-47081 fixed (.netrc credential leak)

# ğŸ”Š Audio Input/Output
sounddevice==0.5.1
soundfile==0.12.1

# ğŸ§  AI / ML Models (GPU CUDA 12.4)
# For CPU-only builds: use requirements-cpu.txt instead
# torch 2.6.0 satisfies security fixes for DoS vulnerabilities (GHSA-3749-ghw9-m3mg, GHSA-887c-mr87-cxwp)
# Using PyTorch 2.6.0 + CUDA 12.4 compatibility matrix (verified working)
torch==2.6.0+cu124
torchvision==0.21.0+cu124
torchaudio==2.6.0+cu124

# transformers 4.57.3: Fixes CVE-2024-XXXX (Deserialization of Untrusted Data)
# Note: BeamSearchScorer moved internally in 4.38+. Compatibility shim in rex/compat/transformers_shims.py
transformers==4.57.3

# TTS and related
TTS==0.22.0                    # Compatible with transformers 4.57.3
openai==1.57.0
ollama==0.4.5
openai-whisper==20240930
openwakeword==0.6.0
numpy==1.26.4

# ğŸ§ª Testing & Environment
pytest==8.3.4
python-dotenv==1.0.1

# ğŸ•¸ï¸ Web Scraping
beautifulsoup4==4.12.3

# ğŸ“ Configuration / Validation
pydantic==2.10.5

# ğŸ”’ Security-Critical Dependencies
# These packages fix known CVEs
cryptography==44.0.1           # CVE-2024-12797 fixed (OpenSSL vulnerability)
setuptools==78.1.1             # PYSEC-2025-49 path traversal fix
pip==25.3                      # CVE-2025-8869 fixed (tar symlink extraction)
werkzeug==3.1.5                # CVE-2025-66221, CVE-2026-21860 fixed (Windows device names)
jinja2==3.1.6                  # CVE-2025-27516 fixed (sandbox escape via |attr filter)
pillow==11.1.0                 # Image processing CVEs
urllib3==2.6.3                 # CVE-2024-47313 fixed (decompression bomb on redirects)
certifi==2024.12.14            # Certificate validation updates

# ğŸ“¡ MQTT Messaging
asyncio-mqtt==0.16.2
